{#---
name: Create Table
description: Generate a CREATE TABLE statement with typed columns, nullability, defaults, and primary key.
category: sql
variables: schema, table_name, columns, primary_key
---#}

CREATE TABLE IF NOT EXISTS {{ schema }}.{{ table_name }} (
    {%- for col in columns %}
    {{ col.name }} {{ col.type }}{% if not col.nullable | default(true) %} NOT NULL{% endif %}{% if col.default is defined %} DEFAULT {{ col.default }}{% endif %}{% if not loop.last %},{% endif %}
    {%- endfor %}
    {%- if primary_key %},
    PRIMARY KEY ({{ primary_key | join(', ') }})
    {%- endif %}
);
