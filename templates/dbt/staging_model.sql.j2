{#---
name: Staging Model
description: Generate a dbt staging model that selects from a source table and renames columns for downstream use.
category: dbt
variables: source_name, table_name, columns
---#}

with source as (

    select * from {{ '{{' }} source('{{ source_name }}', '{{ table_name }}') {{ '}}' }}

),

renamed as (

    select
        {%- for col in columns %}
        {{ col.name }}{% if not loop.last %},{% endif %}
        {%- endfor %}

    from source

)

select * from renamed
