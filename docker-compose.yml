services:
  clawdata:
    build: .
    container_name: clawdata
    volumes:
      - ./data:/app/data
      - ./apps/dbt:/app/apps/dbt
    environment:
      - DB_PATH=/app/data/warehouse.duckdb
      - DATA_FOLDER=/app/data/sample
      - DBT_PROJECT_DIR=/app/apps/dbt
      - DBT_PROFILES_DIR=/app/apps/dbt
    entrypoint: ["clawdata"]
    command: ["help"]

  # Run full pipeline
  pipeline:
    build: .
    container_name: clawdata-pipeline
    volumes:
      - ./data:/app/data
      - ./apps/dbt:/app/apps/dbt
    environment:
      - DB_PATH=/app/data/warehouse.duckdb
      - DATA_FOLDER=/app/data/sample
      - DBT_PROJECT_DIR=/app/apps/dbt
      - DBT_PROFILES_DIR=/app/apps/dbt
    entrypoint: ["clawdata"]
    command: ["run"]
    profiles:
      - pipeline
